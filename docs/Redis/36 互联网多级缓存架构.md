---
sidebarDepth: 3
sidebar: auto
prev:
  text: Back To 目录
  link: /Redis/
typora-root-url: ..\.vuepress\public
---





> 互联网多级缓存架构

1. nginx缓存
2. web中的java本地缓存
3. Redis缓存



![](/images/Redis/80946.png)



## 简单缓存架构

redis-->DB

### 数据冷热分离

热门的数据才缓冲，如果冷门商品也放入缓存，会导致redis数据量过大，压力过大。

在用户访问时，将商品添加到缓存，并设置过期时间。再次访问时延长过期时间。

```java

```







## 缓存击穿（失效）

::: tip

如批量上架商品的时候，设置过期时间都是24小时。24小时过了，都失效了

请求的压力直接打到了数据库DB

:::

```sh
// 设置过期时间
```



## 缓存穿透

::: tip

大量请求访问一个不存在的商品，缓存中没有，数据库中也没有。

:::

解决方案，当从数据库查询出数据后，发现是空的，存一个空对象到redis中。





## 突发性热点数据重建缓存

让一个线程去重建缓存。Double Check双重检测锁，相比使用synchronized,使用分布式锁，粒度更加细。如果使用synchronized 查询id=101和102的都会产生竞争。但是使用分布式锁，分别锁101,和102那么就会粒度降低下来。
