---
sidebarDepth: 3
sidebar: auto
prev:
  text: Back To 目录
  link: /ddd/
typora-root-url: ..\.vuepress\public
---



## DDD分层架构

DDD 的分层架构在不断发展。最早是传统的四层架构；后来四层架构有了进一步的优化， 实现了各层对基础层的解耦；再后来领域层和应用层之间增加了上下文环境（Context） 层，五层架构（DCI）就此形成了

![image-20230526195538371](/images/ddd/image-20230526195538371.png)

在最早的传统四层架构中，基础层是被其它层依赖的，它位于最核 心的位置，那按照分层架构的思想，它应该就是核心，但实际上领域层才是软件的核心，所 以这种依赖是有问题的。后来我们采用了依赖倒置（Dependency inversion principle,DIP）的设计，优化了传统的四层架构，实现了各层对基础层的解耦

> DDD 分层架构就是优化后的四层架构

![image-20230526195709786](/images/ddd/image-20230526195709786.png)



### 用户接口层

用户接口层负责向用户显示信息和解释用户指令。这里的用户可能是：用户、程序、自动化 测试和批处理脚本等等



### 应用层

应用层又位于领域层之上，因为领域层包含多个聚合，所以它可以协调多个聚合的服务和 领域对象完成服务编排和组合，协作完成业务操作

此外，应用层也是微服务之间交互的通道，它可以调用其它微服务的应用服务，完成微服务 之间的服务组合和编排



### 领域层

领域层的作用是实现企业核心业务逻辑，通过各种校验手段保证业务的正确性。领域层主要体现领域模型的业务能力，它用来表达业务概念、业务状态和业务规则。 

领域层包含聚合根、实体、值对象、领域服务等领域模型中的领域对象。

领域模型的业务逻辑主要是由实体和领域服务来实现的，其中实体会采用充血模型来 实现所有与之相关的业务功能。其次，你要知道，实体和领域对象在实现业务逻辑上不是同 级的，**当领域中的某些功能，单一实体（或者值对象）不能实现时，领域服务就会出马，它 可以组合聚合内的多个实体（或者值对象)**，实现复杂的业务逻辑。



### 基础层

基础层是贯穿所有层的，它的作用就是为其它各层提供通用的技术和基础服务，包括第三方 工具、驱动、消息中间件、网关、文件、缓存以及数据库等。比较常见的功能还是提供数据 库持久化。 

基础层包含基础服务，它采用依赖倒置设计，封装基础资源服务，实现应用层、领域层与基 础层的解耦，降低外部资源变化对应用的影响









