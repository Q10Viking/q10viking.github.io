---
sidebarDepth: 3
sidebar: auto
prev:
  text: Back To 目录
  link: /vuepress/
typora-root-url: ..\.vuepress\public\images\vuepress
---



## docsearch

将 [Algolia DocSearch在新窗口打开](https://docsearch.algolia.com/) 集成到 VuePress 中，为你的文档网站提供搜索功能。

```sh
npm i -D @vuepress/plugin-docsearch@next
```

将我们的博客网站加入 [DocSearch项目](https://docsearch.algolia.com/apply/) ，随后会发送相关信息给我们

配置

```js
  plugins:[
    [ '@vuepress/docsearch',{
      apiKey: '',
      indexName: ''
    }]
  ]
```

::: tip 

但是迟迟没有收到邮件

:::

----------

## 手动执行爬虫

::: tip 

自己构建爬虫

:::

### python环境安装

下载python[Python Release Python 3.8.8 | Python.org](https://www.python.org/downloads/release/python-388/)

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281457627.png" alt="image-20211128145750497" style="zoom:80%;" />

配置环境变量

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281518994.png" alt="image-20211128151751933" style="zoom: 67%;" />

### 安装爬虫环境

::: tip

以下操作基于windows环境，我的是win11

:::

参考[Run your own | DocSearch by Algolia](https://docsearch.algolia.com/docs/legacy/run-your-own/#running-the-crawler-from-the-code-base)

### Algolia环境配置


在 [algolia](https://www.algolia.com)上的dashboad上创建一个应用

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281559173.png" alt="image-20211128155851522" style="zoom:80%;" />

我创建了一个应用，并命名为Blog,然后切换到该应用，点击API keys

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281602375.png" alt="image-20211128160238372" style="zoom:80%;" />

创建一个新的api key,其中需要有相应的权限，根据官网 [Run your own | DocSearch by Algolia](https://docsearch.algolia.com/docs/legacy/run-your-own/#set-up-your-environment)

::: tip

- `APPLICATION_ID` set to your Algolia Application ID
- `API_KEY` set to your API Key. Make sure to use an API key with **write** access to your index. It needs [the ACL `addObject`, `editSettings` and `deleteIndex`](https://www.algolia.com/doc/guides/security/api-keys/#acl).

:::

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281612220.png" alt="image-20211128161151955" style="zoom: 80%;" />

api key用于爬虫上传数据

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281614523.png" alt="image-20211128161441995" style="zoom:80%;" />

### 安装pipenv

[Pipenv & Virtual Environments 官网](https://pipenv.pypa.io/en/latest/install/#installing-pipenv)

```
pip install --user pipenv
```

默认安装在了

```sh
C:\Users\你的用户名\AppData\Roaming\Python\Python38\Scripts
# 如： C:\Users\11930\AppData\Roaming\Python\Python38\Scripts
```

将下载下来的pipenv文件全部拷贝到自己python的安装环境中

<img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202111281530701.png" alt="image-20211128153025611" style="zoom:67%;" />

```sh
# 验证
> pipenv --version
pipenv, version 2021.11.23
```

### 下载爬虫代码

```
git clone https://github.com/algolia/docsearch-scraper.git
```

进入到docsearch-scraper文件夹，并在里面创建**.env**文件

```sh
D:\Github\docsearch-scraper> touch .env
```

在**.env**文件中填入在algolia上配置的application_id和api_key

```sh
APPLICATION_ID=在aloglia上配置的应用ID
API_KEY=在aloglia配置的api key
```

### 配置config.json文件

::: tip

用于爬虫程序使用,在这里我直接爬取在自己机器上运行的博客，因为直接爬取 [https://q10viking.github.io)](https://q10viking.github.io/) 网速较慢

config.json文件如下，我放在了.vuepress文件夹下

:::

```json {4}
{
    "index_name": "your_index_name",
    "start_urls": [
      "http://localhost:8080/"
    ],
    "stop_urls": [],
    "selectors": {
      "lvl0": {
        "selector": ".sidebar-heading.active",
        "global": true,
        "default_value": "Documentation"
      },
      "lvl1": ".theme-default-content h1",
      "lvl2": ".theme-default-content h2",
      "lvl3": ".theme-default-content h3",
      "lvl4": ".theme-default-content h4",
      "lvl5": ".theme-default-content h5",
      "text": ".theme-default-content p, .theme-default-content li",
      "lang": {
        "selector": "/html/@lang",
        "type": "xpath",
        "global": true
      }
    },
    "custom_settings": {
      "attributesForFaceting": ["lang"]
    }
  }
```



### 执行爬虫

进入到文件夹docsearch-scraper，执行代码

```

```



## 参考

[docSearch配置](https://v2.vuepress.vuejs.org/zh/reference/plugin/docsearch.html#%E5%AE%89%E8%A3%85)

[Run your own | DocSearch by Algolia](https://docsearch.algolia.com/docs/legacy/run-your-own/#set-up-your-environment)

