Socket与http请求

## 长连接

::: tip

connect:keep-alive分析，多个http请求可以公用一个socket进行收发数据

和close

:::



**http协议的解析**，编写一个客户端的socket来请求tomcat  "主要是请求行和请求头"

通过01010的字节数据传输到机器上。tomcat中从Socket缓冲区中，取一部分数据到JVM的缓冲区。byte 可以对应起来一个character，这样就转换成字符，根据http协议，将http解析出来，设置到具体类的属性当中。



## 请求体的处理

方式1： **content-length**:   可以长度标记请求体的结束 tomcat对应的处理IdentityInputFilter

方式二：**分块传输**

```
Transfer-Encoding: chunked


数据
2\r\n      这是一个分块，表示要传输的数据长度是2
aa\r\n

1\r\n      这也是一个分块，表示要传输的数据长度是1
a\r\n

0\r\n      标记请求体的结束
\r\n
```

**在长连接的过程请求的处理是串行的: ** 处理了一个请求，然后再处理另外一个请求。请求处理完成，**缓存的字节数组的复用**。

区分好：长连接与请求的关系。长连接过程中会发送多个请求。短链接过程中只会发送一个请求。
