"use strict";(self.webpackChunkq10viking_github_io=self.webpackChunkq10viking_github_io||[]).push([[22611],{65323:(n,a,s)=>{s.r(a),s.d(a,{data:()=>t});const t={key:"v-5f0e3d4b",path:"/mybatis/03%20%E6%97%A5%E5%BF%97.html",title:"",lang:"zh-CN",frontmatter:{sidebarDepth:3,sidebar:"auto",prev:{text:"Back To 目录",link:"/mybatis/"},"typora-root-url":"..\\.vuepress\\public"},excerpt:"",headers:[{level:2,title:"日志的好处",slug:"日志的好处",children:[]},{level:2,title:"市面上常见的日志框架",slug:"市面上常见的日志框架",children:[{level:3,title:"日志框架实现",slug:"日志框架实现",children:[]},{level:3,title:"日志门面",slug:"日志门面",children:[]},{level:3,title:"桥接器",slug:"桥接器",children:[]},{level:3,title:"推荐slf4j+logback⭐",slug:"推荐slf4j-logback⭐",children:[]}]},{level:2,title:"MyBatis实现日志",slug:"mybatis实现日志",children:[{level:3,title:"logback配置",slug:"logback配置",children:[]}]},{level:2,title:"参考",slug:"参考",children:[]}],filePathRelative:"mybatis/03 日志.md"}},93104:(n,a,s)=>{s.r(a),s.d(a,{default:()=>d});var t=s(20641);const p=(0,t.Fv)('<h2 id="日志的好处" tabindex="-1"><a class="header-anchor" href="#日志的好处" aria-hidden="true">#</a> 日志的好处</h2><ol><li>日志可以按照级别输出，可以按照类或者包来输出</li><li>日志可以输出到文件中，方便跟踪和排查</li><li>日志可以按照日期和日志文件的大小进行归档</li><li>可以发送邮件给开发人员</li><li>自定义日志格式</li><li>日志性能好：不会阻塞主线程，他是异步的</li></ol><h2 id="市面上常见的日志框架" tabindex="-1"><a class="header-anchor" href="#市面上常见的日志框架" aria-hidden="true">#</a> 市面上常见的日志框架</h2><h3 id="日志框架实现" tabindex="-1"><a class="header-anchor" href="#日志框架实现" aria-hidden="true">#</a> 日志框架实现</h3><table><thead><tr><th>名称</th><th>组织</th><th>描述</th></tr></thead><tbody><tr><td>log4j</td><td>apache</td><td></td></tr><tr><td>JUL</td><td>jdk</td><td>java util logging</td></tr><tr><td>logback</td><td></td><td>基于log4j开发，性能更好</td></tr><tr><td>log4j2</td><td>apache</td><td>很先进，但是有可能与其他框架不适配</td></tr></tbody></table><p>由于市场上存在了很多日志框架实现，slf4j的出现，统一了所有日志的出口。日志门面，集成其他的框架，不是实现日志功能。</p><h3 id="日志门面" tabindex="-1"><a class="header-anchor" href="#日志门面" aria-hidden="true">#</a> 日志门面</h3><table><thead><tr><th>名称</th><th>组织</th><th>描述</th></tr></thead><tbody><tr><td>slf4j</td><td></td><td>Simple Logging Facade for Java</td></tr><tr><td>JCL</td><td>jdk</td><td>Jakarta Commons Logging<br>commons-logging-xx.jar</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>\n<span class="token comment">//省略</span>\n<span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">Test</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// 省略</span>\nlogger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="桥接器" tabindex="-1"><a class="header-anchor" href="#桥接器" aria-hidden="true">#</a> 桥接器</h3><p>日志门面接口本身通常并没有实际的日志输出能力，它底层还是需要去调用具体的日志框架API的，也就是实际上它需要跟具体的日志框架结合使用。由于具体日志框架比较多，而且互相也大都不兼容，日志门面接口要想实现与任意日志框架结合可能需要对应的桥接器</p><p><img src="/images/mybatis/image-20220807141204652.png" alt="image-20220807141204652"></p><h3 id="推荐slf4j-logback⭐" tabindex="-1"><a class="header-anchor" href="#推荐slf4j-logback⭐" aria-hidden="true">#</a> 推荐slf4j+logback⭐</h3><p>对于Log4j , JDK logging, tinylog 等工具， 需要一个适配层(桥接器)， 把SLF4J 的API转化成具体工具的调用接口。</p><p>由于Logback这个工具也处置SLF4J的作者之后， 直接实现了SLF4J的API，所以连适配层都不需要了， 用起来速度飞快，效率最高</p><p><img src="/images/mybatis/image-20220807142445807.png" alt="image-20220807142445807"></p><p>maven中直接引入logback-classic模块即可,这个模块里面依赖了slf4j-api和logback-core</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-classic --&gt;</span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>logback-classic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>\n    <span class="token comment">&lt;!--            &lt;scope&gt;test&lt;/scope&gt;--&gt;</span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/images/mybatis/image-20220807144228196.png" alt="image-20220807144228196"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>hzz</span><span class="token punctuation">;</span>\n\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogbackTest</span> <span class="token punctuation">{</span>\n    <span class="token annotation punctuation">@Test</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">LogbackTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token doc-comment comment">/**\n * 14:41:04.765 [main] INFO org.hzz.LogbackTest - Hello World\n */</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="mybatis实现日志" tabindex="-1"><a class="header-anchor" href="#mybatis实现日志" aria-hidden="true">#</a> MyBatis实现日志</h2>',21),e={href:"https://logbackcn.gitbook.io/logback/",target:"_blank",rel:"noopener noreferrer"},o=(0,t.Lk)("p",null,"slf4j+logback,直接引入依赖",-1),l={href:"https://github.com/Q10Viking/learncode/tree/main/mybatis/02_mybatis_logging",target:"_blank",rel:"noopener noreferrer"},c=(0,t.Fv)('<div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-classic --&gt;</span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>ch.qos.logback<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>logback-classic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>\n    <span class="token comment">&lt;!--            &lt;scope&gt;test&lt;/scope&gt;--&gt;</span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="logback配置" tabindex="-1"><a class="header-anchor" href="#logback配置" aria-hidden="true">#</a> logback配置</h3>',2),r={href:"https://logbackcn.gitbook.io/logback/03-di-san-zhang-logback-de-pei-zhi",target:"_blank",rel:"noopener noreferrer"},u=(0,t.Fv)('<p>在logback初始化的步骤中会寻找logback.xml文件</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>STDOUT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>\n            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{100} - %msg%n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>\n\n    <span class="token comment">&lt;!--  为指定的包路径设置日志级别  --&gt;</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.hzz.mapper<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>debug<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">&gt;</span></span>\n\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>STDOUT<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>可以为指定的包设置日志级别，输出</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">14</span>:57:26.742 <span class="token punctuation">[</span>main<span class="token punctuation">]</span> DEBUG org.hzz.mapper.EmpMapper.selectEmp - <span class="token operator">==</span><span class="token operator">&gt;</span>  Preparing: <span class="token keyword">select</span> * from emp where <span class="token function">id</span> <span class="token operator">=</span> ?\n<span class="token number">14</span>:57:26.770 <span class="token punctuation">[</span>main<span class="token punctuation">]</span> DEBUG org.hzz.mapper.EmpMapper.selectEmp - <span class="token operator">==</span><span class="token operator">&gt;</span> Parameters: <span class="token number">1</span><span class="token punctuation">(</span>Integer<span class="token punctuation">)</span>\n<span class="token number">14</span>:57:26.792 <span class="token punctuation">[</span>main<span class="token punctuation">]</span> DEBUG org.hzz.mapper.EmpMapper.selectEmp - <span class="token operator">&lt;=</span><span class="token operator">=</span>      Total: <span class="token number">1</span>\nEmp<span class="token punctuation">{</span>id<span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token string">&#39;q10viking&#39;</span><span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2>',5),i={href:"https://mp.weixin.qq.com/s/8VvBdRH_Yc-Dt4HFGbC5rg",target:"_blank",rel:"noopener noreferrer"},k={href:"https://mp.weixin.qq.com/s/XiCky-Z8-n4vqItJVHjDIg",target:"_blank",rel:"noopener noreferrer"},g={href:"https://logbackcn.gitbook.io/logback/",target:"_blank",rel:"noopener noreferrer"},b={},d=(0,s(66262).A)(b,[["render",function(n,a){const s=(0,t.g2)("OutboundLink");return(0,t.uX)(),(0,t.CE)(t.FK,null,[p,(0,t.Lk)("p",null,[(0,t.Lk)("a",e,[(0,t.eW)("Introduction - logback (gitbook.io)"),(0,t.bF)(s)])]),o,(0,t.Lk)("p",null,[(0,t.Lk)("a",l,[(0,t.eW)("Source Code 02 mybatis logging"),(0,t.bF)(s)])]),c,(0,t.Lk)("p",null,[(0,t.Lk)("a",r,[(0,t.eW)("第三章：logback 的配置 - logback (gitbook.io)"),(0,t.bF)(s)])]),u,(0,t.Lk)("p",null,[(0,t.Lk)("a",i,[(0,t.eW)("架构师必备，带你弄清混乱的JAVA日志体系！ (qq.com)"),(0,t.bF)(s)])]),(0,t.Lk)("p",null,[(0,t.Lk)("a",k,[(0,t.eW)("一个著名的日志系统是怎么设计出来的？ (qq.com)"),(0,t.bF)(s)])]),(0,t.Lk)("p",null,[(0,t.Lk)("a",g,[(0,t.eW)("Introduction - logback (gitbook.io)"),(0,t.bF)(s)])])],64)}]])},66262:(n,a)=>{a.A=(n,a)=>{const s=n.__vccOpts||n;for(const[n,t]of a)s[n]=t;return s}}}]);