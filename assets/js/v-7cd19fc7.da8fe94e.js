"use strict";(self.webpackChunkq10viking_github_io=self.webpackChunkq10viking_github_io||[]).push([[12216],{72021:(s,n,a)=>{a.r(n),a.d(n,{data:()=>p});const p={key:"v-7cd19fc7",path:"/ElasticStack/21%20%E6%90%9C%E7%B4%A2%E5%BB%BA%E8%AE%AE.html",title:"",lang:"zh-CN",frontmatter:{sidebarDepth:3,sidebar:"auto",prev:{text:"Back To 目录",link:"/ElasticStack/"},"typora-root-url":"..\\.vuepress\\public"},excerpt:"",headers:[{level:2,title:"suggest search(completion suggest)",slug:"suggest-search-completion-suggest",children:[]},{level:2,title:"suggest 搜索",slug:"suggest-搜索",children:[]}],filePathRelative:"ElasticStack/21 搜索建议.md"}},83358:(s,n,a)=>{a.r(n),a.d(n,{default:()=>e});const p=(0,a(20641).Fv)('<h2 id="suggest-search-completion-suggest" tabindex="-1"><a class="header-anchor" href="#suggest-search-completion-suggest" aria-hidden="true">#</a> <strong>suggest search(completion suggest)</strong></h2><p>suggest search（completion suggest）：就是建议搜索或称为搜索建议，也可以叫做自动完成-auto completion。类似百度中的搜索联想提示功能。</p><p>ES实现suggest的时候，性能非常高，其构建的不是倒排索引，也不是正排索引，就是纯的用于进行前缀搜索的一种特殊的数据结构，而且会<strong>全部放在内存中，所以suggest search进行的前缀搜索提示，性能是非常高</strong></p><p>需要使用suggest的时候，<strong>必须在定义index时，为其mapping指定开启suggest</strong>。具体如下：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># fields差不多相当于子字段的意思\nPUT /movie\n<span class="token punctuation">{</span>\n  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>\n        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>\n        <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n          <span class="token property">&quot;suggest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;completion&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>\n        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ik_max_word&quot;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>准备一下数据，注意这些数据的title都是以西游记开始的</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>PUT /movie/_doc/<span class="token number">1</span>\n<span class="token punctuation">{</span>\n  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;西游记电影系列&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token string">&quot;西游记之月光宝盒将与2021年进行......&quot;</span>\n<span class="token punctuation">}</span>\n\nPUT /movie/_doc/<span class="token number">2</span>\n<span class="token punctuation">{</span>\n  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;西游记文学系列&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token string">&quot;某知名网络小说作家已经完成了大话西游同名小说的出版&quot;</span>\n<span class="token punctuation">}</span>\n\nPUT /movie/_doc/<span class="token number">3</span>\n<span class="token punctuation">{</span>\n  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;西游记之大话西游手游&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token string">&quot;网易游戏近日出品了大话西游经典IP的手游，正在火爆内测中&quot;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="suggest-搜索" tabindex="-1"><a class="header-anchor" href="#suggest-搜索" aria-hidden="true">#</a> suggest 搜索</h2><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /movie/_search\n<span class="token punctuation">{</span>\n  <span class="token property">&quot;suggest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;my-suggest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;西游记&quot;</span><span class="token punctuation">,</span>\n      <span class="token property">&quot;completion&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;title.suggest&quot;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="/images/elasticsearch/image-20211113054523172.png" alt=""></p>',10),t={},e=(0,a(66262).A)(t,[["render",function(s,n){return p}]])},66262:(s,n)=>{n.A=(s,n)=>{const a=s.__vccOpts||s;for(const[s,p]of n)a[s]=p;return a}}}]);