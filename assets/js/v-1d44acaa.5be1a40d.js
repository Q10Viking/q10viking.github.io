"use strict";(self.webpackChunkq10viking_github_io=self.webpackChunkq10viking_github_io||[]).push([[425],{33240:(s,n,e)=>{e.r(n),e.d(n,{data:()=>a});const a={key:"v-1d44acaa",path:"/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html",title:"",lang:"zh-CN",frontmatter:{sidebarDepth:3,sidebar:"auto",prev:{text:"Back To 目录",link:"/tomcat/"}},excerpt:"",headers:[{level:2,title:"Session",slug:"session",children:[]},{level:2,title:"session ID",slug:"session-id",children:[]},{level:2,title:"Client and Container exchange sessionID",slug:"client-and-container-exchange-sessionid",children:[]},{level:2,title:"Container create and get Session",slug:"container-create-and-get-session",children:[]},{level:2,title:"Session存活时间",slug:"session存活时间",children:[]},{level:2,title:"Setting session timeout",slug:"setting-session-timeout",children:[{level:3,title:"Configuring session timeout in the DD",slug:"configuring-session-timeout-in-the-dd",children:[]},{level:3,title:"Setting session timeout for a specifi c session",slug:"setting-session-timeout-for-a-specifi-c-session",children:[]}]}],filePathRelative:"tomcat/09 Servlet规范Session解读.md"}},4646:(s,n,e)=>{e.r(n),e.d(n,{default:()=>i});const a=(0,e(20641).Fv)('<h2 id="session" tabindex="-1"><a class="header-anchor" href="#session" aria-hidden="true">#</a> Session</h2><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061605044.jpg" alt="image (15)"></p><h2 id="session-id" tabindex="-1"><a class="header-anchor" href="#session-id" aria-hidden="true">#</a> session ID</h2><p>on the client’s first request, the Container generates a unique session ID and gives it back to the client with the response. The client sends back the session ID with each subsequent request. The Container sees the ID, finds the matching session, and associates the session with the request.</p><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061608848.jpg" alt="image (16)"></p><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061609586.jpg" alt="image (17)"></p><h2 id="client-and-container-exchange-sessionid" tabindex="-1"><a class="header-anchor" href="#client-and-container-exchange-sessionid" aria-hidden="true">#</a> Client and Container exchange sessionID</h2><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061611750.jpg" alt="image (18)"></p><h2 id="container-create-and-get-session" tabindex="-1"><a class="header-anchor" href="#container-create-and-get-session" aria-hidden="true">#</a> Container create and get Session</h2><p>1️⃣ You do have to tell the Container that you want to create or use a session, but the Container takes care of generating the session ID, creating a new Cookie object, stuffing the session ID into the cookie, and setting the cookie as part of the response</p><p>2️⃣ And on subsequent requests, the Container gets the session ID from a cookie in the request, matches the session ID with an existing session, and associates that session with the current request.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// That’s it. Somewhere in your service method you ask for a session, and everything else happens automatically.</span>\n<span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token doc-comment comment">/**\n1. You don’t make the new HttpSession object yourself.\n2. You don’t generate the unique session ID.\n3. You don’t make the new Cookie object.\n4. You don’t associate the session ID with the cookie.\n5. You don’t set the Cookie into the response(under the Set-Cookie header).\nAll the cookie work happens behind the scenes.\n*/</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token constant">IF</span> <span class="token punctuation">(</span>the request includes a session <span class="token class-name">ID</span> cookie<span class="token punctuation">)</span>\n\tfind the session matching that <span class="token constant">ID</span>\n<span class="token class-name">ELSE</span> <span class="token constant">IF</span> <span class="token punctuation">(</span>there’s no session <span class="token constant">ID</span> cookie <span class="token constant">OR</span> there’s no current session matching the session <span class="token constant">ID</span><span class="token punctuation">)</span>\n\tcreate a <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">session<span class="token punctuation">.</span></span>\n    \nAll</span> the cookie work happens behind the scenes<span class="token punctuation">.</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>如果判断session是之前创建的还是刚刚创建的</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>session<span class="token punctuation">.</span><span class="token function">isNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="session存活时间" tabindex="-1"><a class="header-anchor" href="#session存活时间" aria-hidden="true">#</a> Session存活时间</h2><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061627210.jpg" alt="image (19)"></p><h2 id="setting-session-timeout" tabindex="-1"><a class="header-anchor" href="#setting-session-timeout" aria-hidden="true">#</a> Setting session timeout</h2><h3 id="configuring-session-timeout-in-the-dd" tabindex="-1"><a class="header-anchor" href="#configuring-session-timeout-in-the-dd" aria-hidden="true">#</a> Configuring session timeout in the DD</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">...</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>\n        ...\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span> \n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-config</span><span class="token punctuation">&gt;</span></span>\n    \t<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-timeout</span><span class="token punctuation">&gt;</span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-timeout</span><span class="token punctuation">&gt;</span></span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-config</span><span class="token punctuation">&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="setting-session-timeout-for-a-specifi-c-session" tabindex="-1"><a class="header-anchor" href="#setting-session-timeout-for-a-specifi-c-session" aria-hidden="true">#</a> Setting session timeout for a specifi c session</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// The argument to the method is in seconds,</span>\n<span class="token comment">//so this says if the client doesn’t make any</span>\n<span class="token comment">//requests on the session for 20 minutes, kill it.*</span>\nsession<span class="token punctuation">.</span><span class="token function">setMaxInactiveInterval</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token operator">*</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>',22),t={},i=(0,e(66262).A)(t,[["render",function(s,n){return a}]])},66262:(s,n)=>{n.A=(s,n)=>{const e=s.__vccOpts||s;for(const[s,a]of n)e[s]=a;return e}}}]);