"use strict";(self.webpackChunkq10viking_github_io=self.webpackChunkq10viking_github_io||[]).push([[48347],{99882:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-718b12fb",path:"/vue3/06%20%E4%BE%A6%E5%90%AC%E5%99%A8.html",title:"",lang:"zh-CN",frontmatter:{sidebarDepth:3,sidebar:"auto",prev:{text:"Back To 目录",link:"/vue3/"}},excerpt:"",headers:[{level:2,title:"Watcher",slug:"watcher",children:[]},{level:2,title:"Async with Watch",slug:"async-with-watch",children:[]},{level:2,title:"watch循环问题？",slug:"watch循环问题",children:[]}],filePathRelative:"vue3/06 侦听器.md"}},11525:(n,s,a)=>{a.r(s),a.d(s,{default:()=>d});var t=a(20641),e=a(90033);const p=(0,t.Lk)("h2",{id:"watcher",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#watcher","aria-hidden":"true"},"#"),(0,t.eW)(" Watcher")],-1),k=(0,t.Lk)("div",{class:"custom-container tip"},[(0,t.Lk)("p",{class:"custom-container-title"},"TIP"),(0,t.Lk)("p",null,"1️⃣能watch data中的属性也能watch computed properties"),(0,t.Lk)("p",null,"2️⃣ 不返回值")],-1),o=(0,t.Fv)('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n        <span class="token literal-property property">price</span><span class="token operator">:</span> <span class="token number">0</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 侦听price，当它发生变化时</span>\n    <span class="token function">price</span><span class="token punctuation">(</span><span class="token parameter">newValue<span class="token punctuation">,</span>preValue</span><span class="token punctuation">)</span><span class="token punctuation">{</span>\n        <span class="token comment">// ...</span>\n        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">price原来是</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>preValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">现在变成</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>newValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>当computed和watcher都能实现的功能，建议使用computed，因为更加简洁</p></div><h2 id="async-with-watch" tabindex="-1"><a class="header-anchor" href="#async-with-watch" aria-hidden="true">#</a> Async with Watch</h2>',3),c={href:"https://v3.vuejs.org/guide/computed.html#watchers",target:"_blank",rel:"noopener noreferrer"},l=(0,t.Lk)("p",null,"官网的例子更有说服力： This is most useful when you want to perform asynchronous or expensive operations in response to changing data.",-1),r=(0,t.Lk)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t.Lk)("pre",{class:"language-html"},[(0,t.Lk)("code",null,[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"<"),(0,t.eW)("div")]),(0,t.eW)(),(0,t.Lk)("span",{class:"token attr-name"},"id"),(0,t.Lk)("span",{class:"token attr-value"},[(0,t.Lk)("span",{class:"token punctuation attr-equals"},"="),(0,t.Lk)("span",{class:"token punctuation"},'"'),(0,t.eW)("watch-example"),(0,t.Lk)("span",{class:"token punctuation"},'"')]),(0,t.Lk)("span",{class:"token punctuation"},">")]),(0,t.eW)("\n  "),(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"<"),(0,t.eW)("p")]),(0,t.Lk)("span",{class:"token punctuation"},">")]),(0,t.eW)("\n    Ask a yes/no question:\n    "),(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"<"),(0,t.eW)("input")]),(0,t.eW)(),(0,t.Lk)("span",{class:"token attr-name"},"v-model"),(0,t.Lk)("span",{class:"token attr-value"},[(0,t.Lk)("span",{class:"token punctuation attr-equals"},"="),(0,t.Lk)("span",{class:"token punctuation"},'"'),(0,t.eW)("question"),(0,t.Lk)("span",{class:"token punctuation"},'"')]),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"/>")]),(0,t.eW)("\n  "),(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"</"),(0,t.eW)("p")]),(0,t.Lk)("span",{class:"token punctuation"},">")]),(0,t.eW)("\n  "),(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"<"),(0,t.eW)("p")]),(0,t.Lk)("span",{class:"token punctuation"},">")]),(0,t.eW)("{{ answer }}"),(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"</"),(0,t.eW)("p")]),(0,t.Lk)("span",{class:"token punctuation"},">")]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token tag"},[(0,t.Lk)("span",{class:"token punctuation"},"</"),(0,t.eW)("div")]),(0,t.Lk)("span",{class:"token punctuation"},">")]),(0,t.eW)("\n")])]),(0,t.Lk)("div",{class:"highlight-lines"},[(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("div",{class:"highlight-line"}," "),(0,t.Lk)("br"),(0,t.Lk)("div",{class:"highlight-line"}," "),(0,t.Lk)("br")]),(0,t.Lk)("div",{class:"line-numbers"},[(0,t.Lk)("span",{class:"line-number"},"1"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"2"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"3"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"4"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"5"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"6"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"7"),(0,t.Lk)("br")])],-1),u=(0,t.Lk)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t.Lk)("pre",{class:"language-javascript"},[(0,t.Lk)("code",null,[(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("script src"),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.Lk)("span",{class:"token string"},'"https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"'),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.Lk)("span",{class:"token operator"},"/"),(0,t.eW)("script"),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("script"),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)("\n  "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" watchExampleVM "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" Vue"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"createApp"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token function"},"data"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token literal-property property"},"question"),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},"''"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token literal-property property"},"answer"),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},"'Questions usually contain a question mark. ;-)'"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token literal-property property"},"watch"),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token comment"},"// whenever question changes, this function will run"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token function"},"question"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token parameter"},[(0,t.eW)("newQuestion"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" oldQuestion")]),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("newQuestion"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"indexOf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},"'?'"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"-"),(0,t.Lk)("span",{class:"token number"},"1"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n          "),(0,t.Lk)("span",{class:"token keyword"},"this"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"getAnswer"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token literal-property property"},"methods"),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token function"},"getAnswer"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"this"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("answer "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},"'Thinking...'"),(0,t.eW)("\n        axios\n          "),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"get"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},"'https://yesno.wtf/api'"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n          "),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"then"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token parameter"},"response"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"=>"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n            "),(0,t.Lk)("span",{class:"token keyword"},"this"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("answer "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" response"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("data"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("answer\n          "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n          "),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"catch"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token parameter"},"error"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"=>"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n            "),(0,t.Lk)("span",{class:"token keyword"},"this"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("answer "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},"'Error! Could not reach the API. '"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"+"),(0,t.eW)(" error\n          "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n      "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n  "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"mount"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},"'#watch-example'"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.Lk)("span",{class:"token operator"},"/"),(0,t.eW)("script"),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)("\n")])]),(0,t.Lk)("div",{class:"highlight-lines"},[(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("div",{class:"highlight-line"}," "),(0,t.Lk)("br"),(0,t.Lk)("div",{class:"highlight-line"}," "),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("div",{class:"highlight-line"}," "),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br"),(0,t.Lk)("br")]),(0,t.Lk)("div",{class:"line-numbers"},[(0,t.Lk)("span",{class:"line-number"},"1"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"2"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"3"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"4"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"5"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"6"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"7"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"8"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"9"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"10"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"11"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"12"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"13"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"14"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"15"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"16"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"17"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"18"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"19"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"20"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"21"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"22"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"23"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"24"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"25"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"26"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"27"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"28"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"29"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"30"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"31"),(0,t.Lk)("br"),(0,t.Lk)("span",{class:"line-number"},"32"),(0,t.Lk)("br")])],-1),i=(0,t.Lk)("h2",{id:"watch循环问题",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#watch循环问题","aria-hidden":"true"},"#"),(0,t.eW)(" watch循环问题？")],-1),L=(0,t.Lk)("div",{class:"custom-container tip"},[(0,t.Lk)("p",{class:"custom-container-title"},"TIP"),(0,t.Lk)("p",null,"如果是改变自身的值，如果与之前的相同则不会再次触发")],-1),b=(0,t.Lk)("p",null,"下面这个例子，watch会不断自身执行下去",-1),h=(0,t.Lk)("hr",null,null,-1);var m=a(50953);const W={setup:()=>({price:(0,m.KR)(0)}),watch:{price(n,s){alert(`price原来是${s}现在变成${n}`)}}},d=(0,a(66262).A)(W,[["render",function(n,s,a,m,W,d){const g=(0,t.g2)("OutboundLink"),w=(0,t.g2)("common-codepen-snippet"),v=(0,t.g2)("CodeGroupItem"),f=(0,t.g2)("CodeGroup");return(0,t.uX)(),(0,t.CE)(t.FK,null,[p,k,(0,t.Lk)("p",null,[(0,t.eW)("price: "),(0,t.Lk)("span",null,(0,e.v_)(m.price),1),(0,t.eW)(),(0,t.Lk)("button",{onClick:s[0]||(s[0]=n=>m.price++)}," 👉改变price的值 ")]),o,(0,t.Lk)("p",null,[(0,t.Lk)("a",c,[(0,t.eW)("Computed Properties and Watchers | Vue.js (vuejs.org)"),(0,t.bF)(g)])]),l,(0,t.bF)(w,{title:"Watch basic example",slug:"GRJGqXp",team:!0,user:"Vue"}),(0,t.bF)(f,null,{default:(0,t.k6)((()=>[(0,t.bF)(v,{title:"html"},{default:(0,t.k6)((()=>[r])),_:1}),(0,t.bF)(v,{title:"js"},{default:(0,t.k6)((()=>[u])),_:1})])),_:1}),i,L,(0,t.bF)(w,{title:"watch noloop 1",slug:"wvraWPj"}),b,(0,t.bF)(w,{title:"watch loop",slug:"xxXGOzV"}),h],64)}]])},66262:(n,s)=>{s.A=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}}}]);