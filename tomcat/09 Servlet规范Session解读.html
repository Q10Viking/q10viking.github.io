<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" href="/images/favicon-32x32.png"><title>静默のBlog</title><meta name="description" content="静默的Vuepress Blog">
    <link rel="preload" href="/assets/js/runtime~app.2c87fbe0.js" as="script"><link rel="preload" href="/assets/css/styles.b779b927.css" as="style"><link rel="preload" href="/assets/js/95615.aba5921d.js" as="script"><link rel="preload" href="/assets/js/app.4aafd1f6.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.b779b927.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">静默のBlog</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="📗Menu"><!--[--><!--]--> 📗Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/topicNav/" class="nav-link" aria-label="📗Menu"><!--[--><!--]--> 📗Menu <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/aboutme/" class="nav-link" aria-label="AboutMe"><!--[--><!--]--> AboutMe <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/Q10Viking/q10viking.github.io" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item"></p><ul class=""><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#session" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Session"><!--[--><!--]--> Session <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#session-id" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="session ID"><!--[--><!--]--> session ID <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#client-and-container-exchange-sessionid" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Client and Container exchange sessionID"><!--[--><!--]--> Client and Container exchange sessionID <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#container-create-and-get-session" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Container create and get Session"><!--[--><!--]--> Container create and get Session <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#session存活时间" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Session存活时间"><!--[--><!--]--> Session存活时间 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#setting-session-timeout" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setting session timeout"><!--[--><!--]--> Setting session timeout <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#configuring-session-timeout-in-the-dd" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configuring session timeout in the DD"><!--[--><!--]--> Configuring session timeout in the DD <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/tomcat/09%20Servlet%E8%A7%84%E8%8C%83Session%E8%A7%A3%E8%AF%BB.html#setting-session-timeout-for-a-specifi-c-session" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Setting session timeout for a specifi c session"><!--[--><!--]--> Setting session timeout for a specifi c session <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h2 id="session" tabindex="-1"><a class="header-anchor" href="#session" aria-hidden="true">#</a> Session</h2><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061605044.jpg" alt="image (15)"></p><h2 id="session-id" tabindex="-1"><a class="header-anchor" href="#session-id" aria-hidden="true">#</a> session ID</h2><p>on the client’s first request, the Container generates a unique session ID and gives it back to the client with the response. The client sends back the session ID with each subsequent request. The Container sees the ID, finds the matching session, and associates the session with the request.</p><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061608848.jpg" alt="image (16)"></p><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061609586.jpg" alt="image (17)"></p><h2 id="client-and-container-exchange-sessionid" tabindex="-1"><a class="header-anchor" href="#client-and-container-exchange-sessionid" aria-hidden="true">#</a> Client and Container exchange sessionID</h2><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061611750.jpg" alt="image (18)"></p><h2 id="container-create-and-get-session" tabindex="-1"><a class="header-anchor" href="#container-create-and-get-session" aria-hidden="true">#</a> Container create and get Session</h2><p>1️⃣ You do have to tell the Container that you want to create or use a session, but the Container takes care of generating the session ID, creating a new Cookie object, stuffing the session ID into the cookie, and setting the cookie as part of the response</p><p>2️⃣ And on subsequent requests, the Container gets the session ID from a cookie in the request, matches the session ID with an existing session, and associates that session with the current request.</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// That’s it. Somewhere in your service method you ask for a session, and everything else happens automatically.</span>
<span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
1. You don’t make the new HttpSession object yourself.
2. You don’t generate the unique session ID.
3. You don’t make the new Cookie object.
4. You don’t associate the session ID with the cookie.
5. You don’t set the Cookie into the response(under the Set-Cookie header).
All the cookie work happens behind the scenes.
*/</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token constant">IF</span> <span class="token punctuation">(</span>the request includes a session <span class="token class-name">ID</span> cookie<span class="token punctuation">)</span>
	find the session matching that <span class="token constant">ID</span>
<span class="token class-name">ELSE</span> <span class="token constant">IF</span> <span class="token punctuation">(</span>there’s no session <span class="token constant">ID</span> cookie <span class="token constant">OR</span> there’s no current session matching the session <span class="token constant">ID</span><span class="token punctuation">)</span>
	create a <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">session<span class="token punctuation">.</span></span>
    
All</span> the cookie work happens behind the scenes<span class="token punctuation">.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>如果判断session是之前创建的还是刚刚创建的</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>session<span class="token punctuation">.</span><span class="token function">isNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="session存活时间" tabindex="-1"><a class="header-anchor" href="#session存活时间" aria-hidden="true">#</a> Session存活时间</h2><p><img src="https://gitee.com/q10viking/PictureRepos/raw/master/images//202112061627210.jpg" alt="image (19)"></p><h2 id="setting-session-timeout" tabindex="-1"><a class="header-anchor" href="#setting-session-timeout" aria-hidden="true">#</a> Setting session timeout</h2><h3 id="configuring-session-timeout-in-the-dd" tabindex="-1"><a class="header-anchor" href="#configuring-session-timeout-in-the-dd" aria-hidden="true">#</a> Configuring session timeout in the DD</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">...</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">&gt;</span></span>
        ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-config</span><span class="token punctuation">&gt;</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-timeout</span><span class="token punctuation">&gt;</span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-timeout</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-config</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><br><br></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="setting-session-timeout-for-a-specifi-c-session" tabindex="-1"><a class="header-anchor" href="#setting-session-timeout-for-a-specifi-c-session" aria-hidden="true">#</a> Setting session timeout for a specifi c session</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// The argument to the method is in seconds,</span>
<span class="token comment">//so this says if the client doesn’t make any</span>
<span class="token comment">//requests on the session for 20 minutes, kill it.*</span>
session<span class="token punctuation">.</span><span class="token function">setMaxInactiveInterval</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token operator">*</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/tomcat/" class="nav-link router-link-active" aria-label="Back To 目录"><!--[--><!--]--> Back To 目录 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.2c87fbe0.js" defer></script><script src="/assets/js/95615.aba5921d.js" defer></script><script src="/assets/js/app.4aafd1f6.js" defer></script>
  </body>
</html>
